{% extends 'myapp/base.html' %}
{% block content %}

<div class="d-flex justify-content-between align-items-center mb-3">
    <h4 class="fw-semibold mb-0">Permit History</h4>
</div>

<div class="card border-0 shadow-sm">
    <div class="card-body p-0">

        <ul class="list-group list-group-flush">

        {% for h in history %}
        <li class="list-group-item py-3">
            <div class="d-flex justify-content-between align-items-start">

                <!-- LEFT CONTENT -->
                <div>
                    <div class="fw-semibold text-dark">
                        Permit #{{ h.permit.control_no }}
                    </div>

                    <div class="small text-muted">
                        {{ h.previous_status|capfirst }}
                        <span class="mx-1">→</span>
                        <span
                            class="
                                {% if h.new_status == 'active' %}
                                    text-success
                                {% elif h.new_status == 'inactive' %}
                                    text-warning
                                {% else %}
                                    text-danger
                                {% endif %}
                                fw-semibold
                            ">
                            {{ h.new_status|capfirst }}
                        </span>
                    </div>
                {% load tz %}
                <div class="small text-muted mt-1">
                    {{ h.activated_at|localtime|date:"M d, Y" }}
                    • {{ h.activated_at|localtime|time:"h:i A" }}
                </div>

                </div>

                <!-- STATUS BADGE -->
                <span
                    class="badge rounded-pill
                        {% if h.new_status == 'active' %}
                            bg-success-subtle text-success
                        {% elif h.new_status == 'inactive' %}
                            bg-warning-subtle text-warning
                        {% else %}
                            bg-danger-subtle text-danger
                        {% endif %}
                    ">
                    {{ h.new_status|capfirst }}
                </span>

            </div>
        </li>
        {% empty %}
        <li class="list-group-item py-4 text-center text-muted">
            No history available
        </li>
        {% endfor %}

        </ul>

    </div>
</div>

{% endblock %}
